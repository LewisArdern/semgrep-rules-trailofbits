rules:
- id: pickles-in-pandas
  patterns:
    - pattern-either:
      - pattern: pandas.read_pickle(...)
      - pattern: $DF.to_pickle(...)
  message: |
   Functions reliant on pickle can result in arbitrary code execution.  Consider using fickling or switching to a safer serialization method. 
   For more information, see https://www.trailofbits.com/post/never-a-dill-moment-exploiting-machine-learning-pickle-files
  languages: [python]
  severity: WARNING 
