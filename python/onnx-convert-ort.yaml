rules:
- id: onnx-session-options
  message: Loading custom operator libraries can result in arbitrary code execution
  languages: [python]
  severity: WARNING
  metadata:
    category: security
    cwe: "CWE-676: Use of Potentially Dangerous Function"
    subcategory: [audit]
    confidence: LOW
    likelihood: LOW
    impact: MEDIUM
    references:
      - https://onnxruntime.ai/docs/reference/operators/add-custom-op.html

  patterns:
    - pattern: |
        onnxruntime.tools.convert_onnx_models_to_ort $PATH --custom_op_library $PATH"
  