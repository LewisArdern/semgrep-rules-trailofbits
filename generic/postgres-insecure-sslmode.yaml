rules:
  - id: postgres-insecure-sslmode
    message: |
      Found PostgreSQL connection string disabling SSL verification
    languages: [regex]
    severity: WARNING
    metadata:
      category: security
      subcategory: [audit]
      cwe: "CWE-319: Cleartext Transmission of Sensitive Information"
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH
      technology: [postgresql]
      references:
        - https://www.postgresql.org/docs/current/libpq-connect.html
    pattern-regex: "[?&]sslmode=(disable|allow|prefer)"
